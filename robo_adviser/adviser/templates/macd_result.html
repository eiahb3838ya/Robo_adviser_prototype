{% extends "adviser_base.html" %}



{% block resultContent %}
<div class="container">
    <div class="row">
        <h2>you have selected target {{selected_target}} and the strategy {{selected_strategy}}</h2>
    </div>

    <div class="row">
       <div class="col-md-12"><div id="plot">{{plot|safe}}</div></div>
        <div id="result_table_html" class="col-10">
            <table id="datatable"></table>
        </div>

    </div>
    <div class="row">

    </div>

</div>


{% endblock %}
{% block contentJS%}

<script>
    $(document).ready(function(){

        $.ajax({
            url: "not yet",
            type: 'get',
            data:{
                selected_target:"{{selected_target}}"
            },
            success: function(data) {
                $('#plot').empty().append(data);
            },
            failure: function(data) {
                alert('Got an error dude!');

            },
            complete: function(data) {
                var message = 'Time: '+(new Date().getTime() - this.start_time);
                console.log(message);
            }
          });


        var endpoint = "{% url 'adviser:api_macd_table_data' %}"
        var selected_target = columns =  result_table_json = []
        $.ajax({
            method:"GET",
            url:endpoint,
            data:{
                selected_target:"{{selected_target}}"
            },
            success:function(data){
                selected_target=data.selected_target;
                result_table_dict=data.result_table_dict;
                columns = data.columns_dict;
                prepareTable();
            },
            error:function(e){
                alert(e.msg);
            }
        });
        function prepareTable(){
            $('#datatable').bootstrapTable({
                data:result_table_dict,
                columns:columns,
                striped: true,
                pagination: true,
                showColumns: true,
                showToggle: false,
                showExport: true,
                sortable: true,
                paginationVAlign: 'both',
                pageSize: 10,
                pageList: [10, 25, 50, 100, 'ALL'],
            });
        };



    });







</script>




{% endblock%}